---
title: Human Evolution
author: Marc
date: '2018-07-20'
slug: human-evolution
categories: []
tags: []
header:
  caption: ''
  image: ''
---



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggridges)
library(DT)
library(plotly)
```






#Exploring hominin data

This is a temp version of data for my Human Evolution course next Fall. Wanted to spend the first day showing some data and talking about how we can visualize hominin evolution.



Below is a scatterplot of more cranial data. Age is in millions of years. Mouse over to see info (update coming with more interactive features). 

```{r, message=FALSE, error=FALSE, warning=FALSE, echo=FALSE}
cc <-read_csv("CC_data_Updated_2.csv") #read in data
 p2 <- ggplot(cc, aes(x = Age_in_MA_rounded, y = Cranial_capacity, color = Species_2, label = Specimen)) + geom_point() 
#p2
```



```{r, message=FALSE, error=FALSE, warning=FALSE, echo=FALSE}
ggplotly(p2)

```


Finally, boxplots of cranial capacity by species



```{r, message=FALSE, error=FALSE, warning=FALSE, echo=FALSE}
p_box <-  ggplot(cc, aes(x = reorder(Species_2, Cranial_capacity, na.rm = TRUE) , y = Cranial_capacity, fill = Species_2)) + geom_boxplot() + coord_flip() +labs(y= "Cranial Capacity", x = NULL)

p_box

#ggplotly(p_box, height = 600, width = 800)
```






The graph below is a [ridge plot](https://cran.r-project.org/web/packages/ggridges/vignettes/introduction.html), which is a density plot aligned on a horizontal scale. It shows the cranial capacity of various hominin species (species designation taken from referenced sources. Your mileage may vary as to whether these are true species or not...). Dates are estimates for first and last appearance dates. 



```{r, message=FALSE, error=FALSE, warning=FALSE, echo=FALSE }
cc <-read_csv("CC_data_Updated_3.csv") #read in data

cc$Specimen<-iconv(enc2utf8(cc$Specimen),sub="byte") #fix the format of Specimen col


plot10 <- ggplot(cc, aes(x = Cranial_capacity, y = reorder(Species_2, -date2 ),fill = Species_2)) + geom_density_ridges() + theme_ridges() + labs(title = "plot of cranial size in cm^3", subtitle = "data from Schoenemann 2013 & Hawks et al 2017")

plot10a <- plot10 + annotate("text", label = "", x =1, y =1) + theme(axis.title.y = element_blank())

####label

plot10a + 
  annotate("text", size =3 , label = "3.9 - 2.9 ma", x = 150, y = 1.4) +
  annotate("text", size =3, label = "3.1-2.a ma", x = 150, y = 2.4) +
  annotate("text", size =3, label = "2.4-1.4 ma", x = 150, y = 3.4) +
  annotate("text", size =3 ,label = "2.3-1.2 ma", x = 150, y = 4.4) +
  annotate("text", size =3 ,label = "1.8 ma-300? ka", x = 155, y = 5.4) +
  annotate("text", size =3 ,label = "800-~200 ka", x = 150, y = 6.4) +
  annotate("text", size =3 ,label = "334-236 ka", x = 150, y = 7.5) +
  annotate("text", size =3 ,label = "~200-~40 ka", x = 150, y = 8.4)


```








