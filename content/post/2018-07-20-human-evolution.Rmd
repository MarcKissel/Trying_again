---
title: Human Evolution
author: Marc
date: '2018-07-20'
slug: human-evolution
categories: []
tags: []
header:
  caption: ''
  image: ''
---



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggridges)
library(DT)
library(plotly)
```






```{r adding the Data, message=FALSE, error=FALSE, warning=FALSE, echo=FALSE}
cc <-read_csv("CC_data_Updated_2.csv") #read in data

cc$Specimen<-iconv(enc2utf8(cc$Specimen),sub="byte") #fix the format of Specimen col
#cc$Species_2 <- factor(cc$Species_2, levels = cc$Species_2[order(-cc$Age_in_MA_rounded)])
#datatable(cc)
```


#Exploring hominin data

This is a temp version of data for my Human Evolution course next Fall. Wanted to spend the first day showing some data and talking about how we can visualize hominin evolution.

The graph below is a [ridge plot](https://cran.r-project.org/web/packages/ggridges/vignettes/introduction.html), which is a density plot aligned on a horizontal scale. It shows the cranial capacity of various hominin species (species designation taken from referenced sources. Your mileage may vary as to whether these are true species or not...).

```{r, message=FALSE, error=FALSE, warning=FALSE, echo=FALSE }
plot8 <- ggplot(cc, aes(x = Cranial_capacity, y = Species_2, fill = Species_2)) + geom_density_ridges() + theme_ridges() + labs(title = "plot of cranial size in CC", subtitle = "data from Schoenemann 2013 & Hawks et al 2017")
plot8a <- plot8 + annotate("text", label = "", x =1, y =1) + theme(axis.title.y = element_blank())
plot8a + annotate("text", size =3 , label = "3.18 - 3 mya", x = 150, y = 1.4) +
  annotate("text", size =3, label = "3.1-2.5 mya", x = 150, y = 2.4) +
  annotate("text", size =3, label = "1.88-1.5 mya", x = 150, y = 3.4) +
  annotate("text", size =3 ,label = "1.88-1.85 mya", x = 150, y = 4.4) +
  annotate("text", size =3 ,label = "1.85-1.4 mya", x = 150, y = 5.4) +
  annotate("text", size =3 , label = "1.78-1.57 mya", x = 150, y = 6.4) +
  annotate("text", size =3 ,label = "1.7-.236 mya", x = 150, y = 7.4) +
  annotate("text", size =3 ,label = ".800-.130 mya", x = 150, y = 8.5) +
  annotate("text", size =3 ,label = ".565-.565 mya", x = 150, y = 9.4) +
  annotate("text", size =3 ,label = ".335-.236 mya", x = 150, y = 10.4) +
  annotate("text", size =3 ,label = ".250-.010 mya", x = 150, y = 11.4) +
  annotate("text", size =3 ,label = ".130-.040 mya", x = 150, y = 12.4) +
  annotate("text", size =3 ,label = "by Marc Kissel", x =1500, y =.8)
```


Now let's look at data by time. Age is in millions of years. Mouse over to see info (update coming with more interactive features).

```{r, message=FALSE, error=FALSE, warning=FALSE, echo=FALSE}

 p2 <- ggplot(cc, aes(x = Age_in_MA_rounded, y = Cranial_capacity, color = Species_2, label = Specimen)) + geom_point() 
#p2
```



```{r, message=FALSE, error=FALSE, warning=FALSE, echo=FALSE}
ggplotly(p2)

```


Finally, here is a boxplot of cranial capacity by species



```{r, message=FALSE, error=FALSE, warning=FALSE, echo=FALSE}
p_box <-  ggplot(cc, aes(x = reorder(Species_2, Cranial_capacity, na.rm = TRUE) , y = Cranial_capacity, fill = Species_2)) + geom_boxplot() + coord_flip() +labs(y= "Cranial Capacity", x = NULL)

p_box

#ggplotly(p_box, height = 600, width = 800)
```

